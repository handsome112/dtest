{"ast":null,"code":"var _jsxFileName = \"/var/www/dtest.live/src/components/file/image-upload.tsx\";\nvar __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Upload } from 'antd';\nimport { LoadingOutlined, PlusOutlined } from '@ant-design/icons';\nimport React, { PureComponent } from 'react';\n\nfunction getBase64(img, callback) {\n  const reader = new FileReader();\n  reader.addEventListener('load', () => callback(reader.result));\n  reader.readAsDataURL(img);\n}\n\nexport class ImageUpload extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"handleChange\", info => {\n      if (info.file.status === 'uploading') {\n        this.setState({\n          loading: true\n        });\n        return;\n      }\n\n      if (info.file.status === 'done') {\n        // Get this url from response in real world.\n        getBase64(info.fileList[0].originFileObj, imageUrl => {\n          this.setState({\n            imageUrl,\n            loading: false\n          });\n          const {\n            onUploaded\n          } = this.props;\n          onUploaded && onUploaded({\n            response: info.file.response,\n            base64: imageUrl\n          });\n        });\n      }\n    });\n\n    const {\n      imageUrl: _imageUrl\n    } = this.props;\n    this.state = {\n      loading: false,\n      imageUrl: _imageUrl\n    };\n  }\n\n  render() {\n    const {\n      options = {},\n      beforeUpload\n    } = this.props;\n    const {\n      loading\n    } = this.state;\n\n    const uploadButton = __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }\n    }, loading ? __jsx(LoadingOutlined, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 20\n      }\n    }) : __jsx(PlusOutlined, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 42\n      }\n    }), __jsx(\"div\", {\n      className: \"ant-upload-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }\n    }, \"Upload\"));\n\n    const {\n      imageUrl\n    } = this.state;\n    const {\n      headers,\n      uploadUrl\n    } = this.props;\n    return __jsx(Upload, {\n      name: options.fieldName || 'file',\n      listType: \"picture-card\",\n      className: \"avatar-uploader\",\n      showUploadList: false,\n      action: uploadUrl,\n      beforeUpload: beforeUpload,\n      onChange: this.handleChange,\n      headers: headers,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 7\n      }\n    }, imageUrl ? __jsx(\"img\", {\n      src: imageUrl,\n      alt: \"file\",\n      style: {\n        width: '100%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }\n    }) : uploadButton);\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}